<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AqiveLife - 首頁</title>
    <!-- 添加品牌字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 引入共用樣式和頁面特定樣式 -->
    <link rel="stylesheet" href="assets/css/shared.css">
    <link rel="stylesheet" href="assets/css/pages/home.css">
    <!-- 引入共用腳本和頁面特定腳本 -->
    <script src="assets/js/shared.js" defer></script>
    <script src="assets/js/pages/home.js" defer></script>
</head>
<body>
    <!-- iOS 狀態欄 -->
    <div class="status-bar">
        <div class="status-bar-left">
            <div class="status-bar-time">17:02</div>
        </div>
        <div class="status-bar-right">
            <div class="status-bar-signal">
                <i class="fas fa-signal"></i>
            </div>
            <div class="status-bar-wifi">
                <i class="fas fa-wifi"></i>
            </div>
            <div class="status-bar-battery">
                <i class="fas fa-battery-full"></i>
            </div>
        </div>
    </div>
    
    <!-- 主內容區域 -->
    <div class="content">
        <!-- Aqive 使用者區塊 -->
        <div class="header">
            <div class="greeting">Hi，allen</div>
            <div class="date">2025年4月18日 週五</div>
        </div>
        
        <!-- 今日調氣小提示 - 移動到日期下方 -->
        <div class="card-warning tip-card">
            <div class="tip-icon">
                <i class="fas fa-lightbulb"></i>
            </div>
            <div class="tip-content">
                <div class="card-title">今日調氣小提示</div>
                <div class="card-body">嘗試在使用「撓定」時配合深呼吸，每次吸氣5秒，呼氣6秒，可以加強調氣效果。</div>
            </div>
        </div>
        
        <!-- 產品選擇區塊 -->
        <div class="card-raised card-interactive product-selection">
            <div class="product-header">
                <div class="card-title">選擇您的產品</div>
                <a href="#" class="product-action" id="favoritesToggle">顯示全部</a>
            </div>
            
            <!-- 產品使用提示 -->
            <div class="product-usage-tip">
                <div class="product-usage-icon"><i class="fas fa-info-circle"></i></div>
                <div class="product-usage-text">請在調氣前選擇您使用的 Aqive 產品，這將幫助我們為您提供最佳體驗</div>
            </div>
            
            <!-- 簡易分類 -->
            <div class="product-categories">
                <div class="category-pill active" onclick="filterProducts('all', this)">全部</div>
                <div class="category-pill" onclick="filterProducts('氣機', this)">氣機</div>
                <div class="category-pill" onclick="filterProducts('覺之', this)">覺之</div>
            </div>
            
            <!-- 3x3 產品網格 -->
            <div class="products-grid">
                <!-- 氣機品牌 -->
                <div class="product-item" data-product="撓定" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/qi-ease.jpg" alt="撓定">
                    </div>
                    <div class="product-name">撓定</div>
                </div>
                
                <div class="product-item" data-product="撓氣源寶" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/qi-torsion.jpg" alt="撓氣源寶">
                    </div>
                    <div class="product-name">撓氣源寶</div>
                </div>
                
                <div class="product-item" data-product="盒炁" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/qi-box.jpg" alt="盒炁">
                    </div>
                    <div class="product-name">盒炁</div>
                </div>
                
                <div class="product-item" data-product="晶炁" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/qi-crystal.jpg" alt="晶炁">
                    </div>
                    <div class="product-name">晶炁</div>
                </div>
                
                <div class="product-item" data-product="炁環" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/qi-wristband.jpg" alt="炁環">
                    </div>
                    <div class="product-name">炁環</div>
                </div>
                
                <div class="product-item" data-product="水晶金字塔" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/crystalqiramid.jpg" alt="水晶金字塔">
                    </div>
                    <div class="product-name">水晶金字塔</div>
                </div>
                
                <div class="product-item" data-product="銅金字塔" data-category="氣機" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/copperqiramid.jpg" alt="銅金字塔">
                    </div>
                    <div class="product-name">銅金字塔</div>
                </div>
                
                <!-- 覺之品牌 -->
                <div class="product-item" data-product="鈦覺智" data-category="覺之" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/titan-wisdomware.jpg" alt="鈦覺智">
                    </div>
                    <div class="product-name">鈦覺智</div>
                </div>
                
                <div class="product-item" data-product="覺之花" data-category="覺之" onclick="selectProduct(this)">
                    <div class="product-check"></div>
                    <div class="product-image">
                        <img src="assets/images/products/aol.jpg" alt="覺之花">
                    </div>
                    <div class="product-name">覺之花</div>
                </div>
            </div>
            
            <!-- 無產品選項 -->
            <div class="no-product-option" onclick="selectNoProduct(this)" id="noProductOption">
                <div class="no-product-icon">
                    <i class="fas fa-ban"></i>
                </div>
                <div class="no-product-text">
                    <div class="no-product-title">不使用產品</div>
                    <div class="no-product-desc">僅使用APP進行指導體驗，無需實體產品</div>
                </div>
                <div class="no-product-check"></div>
            </div>
        </div>
        
        <div class="main-button-container">
            <button class="super-button" onclick="window.location.href='mode-selector.html'">
                <div class="super-button-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                開啟我的超能力
            </button>
        </div>
        
        <div class="stats-summary">
            <!-- 本週概況卡片 - 使用與產品選擇相同的樣式 -->
            <div class="card-raised stats-card">
                <div class="stats-header">
                    <div class="card-title">本週概況</div>
                    <a href="stats.html" class="stats-action">查看詳情</a>
                </div>
                
                <div class="card-body">
                    <div class="stats-grid">
                        <div class="stats-item">
                            <div class="stats-value">5</div>
                            <div class="stats-label">調氣次數</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-value">-25%</div>
                            <div class="stats-label">焦慮減少</div>
                        </div>
                        <div class="stats-item">
                            <div class="stats-value">+18%</div>
                            <div class="stats-label">專注提升</div>
                        </div>
                    </div>
                    
                    <div class="mood-summary">
                        <div class="mood-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="mood-text">
                            <div class="mood-title">您的狀態正在改善</div>
                            <div class="mood-description">與上週相比，您的整體狀態提升了15%</div>
                        </div>
                    </div>
                    
                    <!-- 產品使用統計 -->
                    <div class="product-stats">
                        <div class="product-stats-title">產品使用情況</div>
                        <div class="product-stats-items">
                            <div class="product-stats-item">
                                <div class="product-stats-icon"><i class="fas fa-praying-hands"></i></div>
                                <div>撓定 • 3次</div>
                            </div>
                            <div class="product-stats-item">
                                <div class="product-stats-icon"><i class="fas fa-gem"></i></div>
                                <div>撓氣源寶 • 1次</div>
                            </div>
                            <div class="product-stats-item">
                                <div class="product-stats-icon"><i class="fas fa-cube"></i></div>
                                <div>盒炁 • 1次</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 近期調氣記錄卡片 -->
            <div class="card-elevated recent-sessions">
                <div class="card-title">近期調氣記錄</div>
                <div class="card-body">
                    <div class="session-list">
                        <div class="session-item">
                            <div class="session-icon relaxation-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="session-details">
                                <div class="session-title">放鬆調氣 • 撓定</div>
                                <div class="session-time">今天 14:30</div>
                            </div>
                            <div class="session-duration">15分鐘</div>
                        </div>
                        
                        <div class="session-item">
                            <div class="session-icon sleep-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="session-details">
                                <div class="session-title">睡眠調氣 • 撓氣源寶</div>
                                <div class="session-time">昨天 22:45</div>
                            </div>
                            <div class="session-duration">20分鐘</div>
                        </div>
                        
                        <div class="session-item">
                            <div class="session-icon focus-icon">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="session-details">
                                <div class="session-title">專注調氣 • 盒炁</div>
                                <div class="session-time">昨天 10:15</div>
                            </div>
                            <div class="session-duration">10分鐘</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 底部導航欄 -->
    <div class="tab-bar">
        <a href="home.html" class="tab-item active">
            <div class="tab-icon">
                <i class="fas fa-home"></i>
            </div>
            <div class="tab-label">首頁</div>
        </a>
        <a href="tracking.html" class="tab-item">
            <div class="tab-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="tab-label">記錄</div>
        </a>
        <a href="stats.html" class="tab-item">
            <div class="tab-icon">
                <i class="fas fa-chart-pie"></i>
            </div>
            <div class="tab-label">數據</div>
        </a>
        <a href="settings.html" class="tab-item">
            <div class="tab-icon">
                <i class="fas fa-cog"></i>
            </div>
            <div class="tab-label">設定</div>
        </a>
    </div>

    <script>
    // 頁面訪問保護 - 檢查登入狀態和條款同意狀態
    document.addEventListener('DOMContentLoaded', function() {
        // 在原型展示模式下，跳過登入狀態檢查
        const isPrototypeMode = window.parent !== window || window.location.href.includes('index.html');
        
        if (!isPrototypeMode) {
            // 檢查用戶是否已登入
            const userLoggedIn = localStorage.getItem('userLoggedIn');
            if (!userLoggedIn || userLoggedIn !== 'true') {
                // 如果未登入，跳轉到登入頁面
                window.location.href = 'login.html';
                return;
            }

            // 檢查用戶是否已同意服務條款
            const termsAgreed = localStorage.getItem('termsAgreed');
            if (!termsAgreed || termsAgreed !== 'true') {
                // 如果未同意條款，跳轉到條款同意頁面
                window.location.href = 'terms-agreement.html';
                return;
            }
        }

        // 如果通過所有檢查，初始化頁面
        initializePage();
    });

    // 初始化頁面功能
    function initializePage() {
        // 恢復之前選擇的產品
        const savedProduct = localStorage.getItem('selectedProduct');
        const usingProduct = localStorage.getItem('usingProduct');
        
        if (usingProduct === 'false') {
            // 恢復不使用產品的選擇
            const noProductOption = document.getElementById('noProductOption');
            if (noProductOption) {
                noProductOption.classList.add('selected');
            }
        } else if (savedProduct) {
            // 恢復選擇特定產品
            const productItem = document.querySelector(`.product-item[data-product="${savedProduct}"]`);
            if (productItem) {
                productItem.classList.add('selected');
                updateSelectedProductStatus(savedProduct);
            }
        }

        // 設置收藏切換功能
        const favoritesToggle = document.getElementById('favoritesToggle');
        if (favoritesToggle) {
            favoritesToggle.addEventListener('click', function(e) {
                e.preventDefault();
                const isShowingAll = this.textContent === '收合產品';
                
                if (isShowingAll) {
                    // 切換回顯示全部
                    document.querySelectorAll('.product-item').forEach(item => {
                        item.style.display = 'flex';
                    });
                    this.textContent = '顯示全部';
                } else {
                    // 顯示前3個項目
                    document.querySelectorAll('.product-item').forEach((item, index) => {
                        item.style.display = index < 3 ? 'flex' : 'none';
                    });
                    this.textContent = '收合產品';
                }
            });
        }
    }

    // 選擇產品
    function selectProduct(element) {
        // 移除所有已選擇的產品和無產品選項
        document.querySelectorAll('.product-item').forEach(item => {
            item.classList.remove('selected');
        });
        const noProductOption = document.getElementById('noProductOption');
        if (noProductOption) {
            noProductOption.classList.remove('selected');
        }
        
        // 將點擊的產品設為選中狀態
        element.classList.add('selected');
        
        // 儲存選中的產品名稱
        const selectedProduct = element.getAttribute('data-product');
        localStorage.setItem('selectedProduct', selectedProduct);
        localStorage.setItem('usingProduct', 'true');
        
        // 更新選中產品狀態
        updateSelectedProductStatus(selectedProduct);
    }

    // 選擇不使用產品
    function selectNoProduct(element) {
        // 移除所有已選擇的產品
        document.querySelectorAll('.product-item').forEach(item => {
            item.classList.remove('selected');
        });
        
        // 將無產品選項設為選中狀態
        element.classList.add('selected');
        
        // 儲存選擇狀態
        localStorage.setItem('selectedProduct', '');
        localStorage.setItem('usingProduct', 'false');
        
        // 更新UI顯示
        console.log('選擇不使用產品');
    }

    // 更新選中產品狀態
    function updateSelectedProductStatus(productName) {
        console.log('已選擇產品：' + productName);
        // 可以在這裡更新其他UI元素或後續操作
    }

    // 產品過濾功能
    function filterProducts(category, element) {
        // 更新分類按鈕狀態
        document.querySelectorAll('.category-pill').forEach(pill => {
            pill.classList.remove('active');
        });
        element.classList.add('active');
        
        // 過濾產品顯示
        const products = document.querySelectorAll('.product-item');
        products.forEach(product => {
            const productCategory = product.getAttribute('data-category');
            if (category === 'all' || productCategory === category) {
                product.style.display = 'flex';
            } else {
                product.style.display = 'none';
            }
        });
    }
    </script>
</body>
</html> 